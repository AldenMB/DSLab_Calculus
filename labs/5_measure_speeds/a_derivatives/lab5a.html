
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Week 12: Laboratory 5a &#8212; The Data Science Labs on Differential and Integral Calculus</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Week 13: Laboratory 5b" href="../b_build_a_tool/lab5b.html" />
    <link rel="prev" title="Week 11: Laboratory 4e" href="../../4_measure_tall_things/e_symbolic_error/lab4e.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">The Data Science Labs on Differential and Integral Calculus</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Intro to Notebooks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../1_intro_to_notebooks/lab0.html">
   Week 1: Laboratory 0
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../1_intro_to_notebooks/lab1.html">
   Week 2: Laboratory 1
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Determine your heart rate
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../2_determine_heart_rate/lab2.html">
   Week 3: Laboratory 2
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Estimate your blood flow
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../3_estimate_blood_flow/lab3.html">
   Week 4: Laboratory 3
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Measure the heights of tall and far away things
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../4_measure_tall_things/a_prepare_for_building_inclinometer/lab4a.html">
   Week 5: Laboratory 4a
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../4_measure_tall_things/b_build_an_inclinometer/lab4b.html">
   Week 6-7: Laboratory 4b
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../4_measure_tall_things/c_make_the_measurements/lab4c.html">
   Week 8-9: Laboratory 4c
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../4_measure_tall_things/d_error_analysis/lab4d.html">
   Week 10: Laboratory 4d
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../4_measure_tall_things/e_symbolic_error/lab4e.html">
   Week 11: Laboratory 4e
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Measure the speeds of nearby things
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Week 12: Laboratory 5a
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../b_build_a_tool/lab5b.html">
   Week 13: Laboratory 5b
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Design a project of your own
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../final_project/labfinal.html">
   Weeks 14-15: Final Project
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/TheDataScienceLabs/DSLab_Calculus/main?urlpath=tree/book/labs/5_measure_speeds/a_derivatives/lab5a.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/TheDataScienceLabs/DSLab_Calculus"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/TheDataScienceLabs/DSLab_Calculus/issues/new?title=Issue%20on%20page%20%2Flabs/5_measure_speeds/a_derivatives/lab5a.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/labs/5_measure_speeds/a_derivatives/lab5a.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-00-content-span">
   <span style="color:orange;">
    00. Content
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-0-required-hardware-span">
   <span style="color:orange;">
    0. Required Hardware
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-1-two-types-of-numbers-in-python-span">
   <span style="color:orange;">
    1. Two Types of Numbers in Python
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#integers">
   Integers
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#floats">
   Floats
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-1-span">
     <span style="color:red;">
      Exercise 1
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-2-troubles-with-floating-point-numbers-span">
   <span style="color:orange;">
    2. Troubles with Floating Point Numbers
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-2-span">
     <span style="color:red;">
      Exercise 2
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-3-catastrophic-cancellation-span">
   <span style="color:orange;">
    3. Catastrophic Cancellation
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-3-span">
     <span style="color:red;">
      Exercise 3
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-4-span">
     <span style="color:red;">
      Exercise 4
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-practical-example-of-catastrophic-cancellation">
     A practical example of catastrophic cancellation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-4-numerical-differentiation-span">
   <span style="color:orange;">
    4. Numerical Differentiation
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-5-span">
     <span style="color:red;">
      Exercise 5
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-5-finite-difference-schemes-span">
   <span style="color:orange;">
    5. Finite Difference Schemes
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bias-in-the-forward-difference">
     Bias in the forward difference
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-6-span">
     <span style="color:red;">
      Exercise 6
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-7-span">
     <span style="color:red;">
      Exercise 7
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correcting-the-bias">
     Correcting the bias
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-8-span">
     <span style="color:red;">
      Exercise 8
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-6-unequal-step-sizes-span">
   <span style="color:orange;">
    6. Unequal Step Sizes
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-quick-way-to-figure-out-alpha-beta-and-gamma">
     A quick way to figure out
     <span class="math notranslate nohighlight">
      \(\alpha\)
     </span>
     ,
     <span class="math notranslate nohighlight">
      \(\beta\)
     </span>
     , and
     <span class="math notranslate nohighlight">
      \(\gamma\)
     </span>
     .
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-9-h3">
     <span style="color:red;">
      Exercise 9
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-10-span">
     <span style="color:red;">
      Exercise 10
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-symmetric-finite-difference-method-with-unequal-step-sizes">
   The symmetric finite difference method with unequal step sizes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-11-h3">
     <span style="color:red;">
      Exercise 11
     </span>
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Week 12: Laboratory 5a</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-00-content-span">
   <span style="color:orange;">
    00. Content
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-0-required-hardware-span">
   <span style="color:orange;">
    0. Required Hardware
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-1-two-types-of-numbers-in-python-span">
   <span style="color:orange;">
    1. Two Types of Numbers in Python
   </span>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#integers">
   Integers
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#floats">
   Floats
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-1-span">
     <span style="color:red;">
      Exercise 1
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-2-troubles-with-floating-point-numbers-span">
   <span style="color:orange;">
    2. Troubles with Floating Point Numbers
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-2-span">
     <span style="color:red;">
      Exercise 2
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-3-catastrophic-cancellation-span">
   <span style="color:orange;">
    3. Catastrophic Cancellation
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-3-span">
     <span style="color:red;">
      Exercise 3
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-4-span">
     <span style="color:red;">
      Exercise 4
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-practical-example-of-catastrophic-cancellation">
     A practical example of catastrophic cancellation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-4-numerical-differentiation-span">
   <span style="color:orange;">
    4. Numerical Differentiation
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-5-span">
     <span style="color:red;">
      Exercise 5
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-5-finite-difference-schemes-span">
   <span style="color:orange;">
    5. Finite Difference Schemes
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bias-in-the-forward-difference">
     Bias in the forward difference
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-6-span">
     <span style="color:red;">
      Exercise 6
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-7-span">
     <span style="color:red;">
      Exercise 7
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#correcting-the-bias">
     Correcting the bias
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-8-span">
     <span style="color:red;">
      Exercise 8
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#span-style-color-orange-6-unequal-step-sizes-span">
   <span style="color:orange;">
    6. Unequal Step Sizes
   </span>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-quick-way-to-figure-out-alpha-beta-and-gamma">
     A quick way to figure out
     <span class="math notranslate nohighlight">
      \(\alpha\)
     </span>
     ,
     <span class="math notranslate nohighlight">
      \(\beta\)
     </span>
     , and
     <span class="math notranslate nohighlight">
      \(\gamma\)
     </span>
     .
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-9-h3">
     <span style="color:red;">
      Exercise 9
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-10-span">
     <span style="color:red;">
      Exercise 10
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-symmetric-finite-difference-method-with-unequal-step-sizes">
   The symmetric finite difference method with unequal step sizes
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-exercise-11-h3">
     <span style="color:red;">
      Exercise 11
     </span>
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="week-12-laboratory-5a">
<h1>Week 12: Laboratory 5a<a class="headerlink" href="#week-12-laboratory-5a" title="Permalink to this headline">#</a></h1>
<p><font size="6"> Preparation to Building a Distance Measurement Tool </font> <br>
<font size="6"> Floating Point Numbers and Numerical Differentiation </font> <br>
<font size="3"> Last updated June 16, 2022 </font></p>
<section id="span-style-color-orange-00-content-span">
<h2><span style="color:orange;"> 00. Content </span><a class="headerlink" href="#span-style-color-orange-00-content-span" title="Permalink to this headline">#</a></h2>
<p><font size="5"> Mathematics </font></p>
<ul class="simple">
<li><p>Approximating derivatives using finite difference schemes</p></li>
<li><p>Approximation bias</p></li>
</ul>
<p><font size="5"> Programming Skills </font></p>
<ul class="simple">
<li><p>Number types: int, float</p></li>
<li><p>Use of underscore as a numerical separator</p></li>
<li><p>Vectorized computation</p></li>
</ul>
<p><font size="5"> Embedded Systems </font></p>
<ul class="simple">
<li><p>N/A</p></li>
</ul>
</section>
<section id="span-style-color-orange-0-required-hardware-span">
<h2><span style="color:orange;"> 0. Required Hardware </span><a class="headerlink" href="#span-style-color-orange-0-required-hardware-span" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>N/A</p></li>
</ul>
<h3 style="background-color:lightblue"> Copy the file `student_info.py` into the folder you are working in, then run this cell to put your name and email into this document.</h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">student_info</span> <span class="kn">import</span> <span class="n">show_info</span>
<span class="n">show_info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="span-style-color-orange-1-two-types-of-numbers-in-python-span">
<h2><span style="color:orange;"> 1. Two Types of Numbers in Python </span><a class="headerlink" href="#span-style-color-orange-1-two-types-of-numbers-in-python-span" title="Permalink to this headline">#</a></h2>
</section>
<section id="integers">
<h2>Integers<a class="headerlink" href="#integers" title="Permalink to this headline">#</a></h2>
<p>One of the benefits of using Python is that it has great support for numbers. This makes it much more friendly for doing math than, for example, Javascript or C. Whole numbers in Python have the type <code class="docutils literal notranslate"><span class="pre">int</span></code>, which is short for Integer. You can check this yourself:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Python <code class="docutils literal notranslate"><span class="pre">int</span></code>s can be as big as you like, positive or negative. It can get a bit cumbersome writing and reading them, and the comma has a special meaning in Python, so you can’t use it to separate big integers for legibility:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">123</span><span class="p">,</span><span class="mi">456</span><span class="p">,</span><span class="mi">789</span>
</pre></div>
</div>
</div>
</div>
<p>That gives us a list of three integers. If you want to refer to the number 123,456,789 you can write it without separations, but it is easier to read if you use the underscore symbol where there would be a comma:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">123_456_789</span> <span class="o">==</span> <span class="mi">123456789</span>
</pre></div>
</div>
</div>
</div>
<p>You can put underscores wherever you like in a number – python ignores them. You could represent a credit card number, for example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">3782_8224_6310_005</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="floats">
<h2>Floats<a class="headerlink" href="#floats" title="Permalink to this headline">#</a></h2>
<p>The other type of number was mentioned in Lab 4e, floating point numbers. As explained previously, floats are used to represent non-whole numbers like decimals. However, they do present some error since Python can only store a certain amount of digits. For most purposes, this relative error is no trouble at all, and if it is posing a problem then the tool introduced last time, SymPy, can be implemented to avoid this.</p>
<section id="span-style-color-red-exercise-1-span">
<h3><span style="color:red;"> Exercise 1 </span><a class="headerlink" href="#span-style-color-red-exercise-1-span" title="Permalink to this headline">#</a></h3>
<p>For each of the following constants, look them up on Wikipedia and report the relative error in their known values. If an error is not given, you can assume the absolute error is <span class="math notranslate nohighlight">\(\pm 1 \)</span> of the last digit given. Note that some times, the absolute error is given in a concise notation, as described here: <a class="reference external" href="https://physics.nist.gov/cgi-bin/cuu/Info/Constants/definitions.html">https://physics.nist.gov/cgi-bin/cuu/Info/Constants/definitions.html</a>. Compare your answers to the relative error in a floating point number. Make sure you are using relative error, not absolute error.</p>
<ul class="simple">
<li><p>mass of an electron</p></li>
<li><p>orbital period of the moon (the Sidereal period, specifically)</p></li>
<li><p>distance from New York to Los Angeles (you can look this one up on Wolfram Alpha instead of Wikipedia)</p></li>
<li><p>freezing point of water (in Kelvin) at atmospheric pressure</p></li>
</ul>
<h3 style="background-color:lightblue"> Write Answers for Exercise 1 Below: </h3></section>
</section>
<section id="span-style-color-orange-2-troubles-with-floating-point-numbers-span">
<h2><span style="color:orange;"> 2. Troubles with Floating Point Numbers </span><a class="headerlink" href="#span-style-color-orange-2-troubles-with-floating-point-numbers-span" title="Permalink to this headline">#</a></h2>
<p>Precision is usually not a problem with floating point numbers, with one major exception which we will address later. The main issue you will face is when comparing numbers. Check this out:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span><span class="o">/</span><span class="mi">10</span> <span class="o">==</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">x</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="span-style-color-red-exercise-2-span">
<h3><span style="color:red;"> Exercise 2 </span><a class="headerlink" href="#span-style-color-red-exercise-2-span" title="Permalink to this headline">#</a></h3>
<p>Explain why a few numbers are missing from the printout above. Include the python values of <code class="docutils literal notranslate"><span class="pre">x/10</span></code> and <code class="docutils literal notranslate"><span class="pre">0.1*x</span></code> in your explanation, for some values of <code class="docutils literal notranslate"><span class="pre">x</span></code> (make a new code cell printing the relevant values).</p>
<h3 style="background-color:lightblue"> Write Answers for Exercise 2 Below </h3><p>There are two main ways to deal with this:</p>
<ol class="simple">
<li><p>Whenever possible, use <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code> or <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code> instead of <code class="docutils literal notranslate"><span class="pre">==</span></code> when comparing floating point numbers. This is usually the best thing to do. For example, if a number is decreasing and you want to know when it hits zero, check if it is positive instead of checking if it’s zero. Or, better yet, check if it’s less than 0.0001, keeping as much precision as you need for your purpose and no more.</p></li>
<li><p>Instead of checking if floats are equal, check if they are close to eachother. For example, the builtin function <code class="docutils literal notranslate"><span class="pre">math.isclose</span></code> can do this for you, or you can use the version in numpy if working with arrays. Here is how that might look:</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">x</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="span-style-color-orange-3-catastrophic-cancellation-span">
<h2><span style="color:orange;"> 3. Catastrophic Cancellation </span><a class="headerlink" href="#span-style-color-orange-3-catastrophic-cancellation-span" title="Permalink to this headline">#</a></h2>
<p>There is one situation where roundoff error is a really big problem. That is when you are subtracting two numbers which are very close together. This isn’t anything special about floating point numbers, this is just a fact about rounding. Here, have a look:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{r}
3.14159265358???\\
-\; 3.14159265332???\\\hline
0.00000000026???
\end{array}
\end{split}\]</div>
<p>We have used question marks to represent unknown digits, i.e. digits which were lost due to rounding. See how the relative error in the output is much bigger than in either of the inputs: each input has 12 significant figures, but the output has only two significant figures. We can do this a bit more precisely by writing the absolute errors explicitly:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
3.14159265358??? &amp;\rightarrow 3.14159265358 \pm 5\times 10^{-12}\\
3.14159265332??? &amp;\rightarrow 3.14159265332 \pm 5\times 10^{-12}\\
0.00000000026??? &amp;\rightarrow 0.00000000026 \pm \text{(you figure this one out)}\\
\end{align*}\]</div>
<section id="span-style-color-red-exercise-3-span">
<h3><span style="color:red;"> Exercise 3 </span><a class="headerlink" href="#span-style-color-red-exercise-3-span" title="Permalink to this headline">#</a></h3>
<p>What is the absolute error in the output? What are the relative errors of each of the inputs, and what is the relative error of the output?</p>
<h3 style="background-color:lightblue"> Write Answers for Exercise 3 Below </h3></section>
<section id="span-style-color-red-exercise-4-span">
<h3><span style="color:red;"> Exercise 4 </span><a class="headerlink" href="#span-style-color-red-exercise-4-span" title="Permalink to this headline">#</a></h3>
</section>
<section id="a-practical-example-of-catastrophic-cancellation">
<h3>A practical example of catastrophic cancellation<a class="headerlink" href="#a-practical-example-of-catastrophic-cancellation" title="Permalink to this headline">#</a></h3>
<p>Before continuing, download <a class="reference external" href="https://github.com/TheDataScienceLabs/DSLab_Calculus/blob/main/book/labs/5_measure_speeds/a_derivatives/lab_5a_checker.py">lab_5a_checker.py</a> (this code imports <a class="reference external" href="http://autograder.py">autograder.py</a>, which was downloaded during Lab 3) to be able to check if your code works properly.</p>
<p>Here we walk you through coding an example where catestrophic cancellation makes a pretty big difference, and something clever you can do to fix it.</p>
<ol class="simple">
<li><p>Write a function which takes the coefficients <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, and <code class="docutils literal notranslate"><span class="pre">c</span></code> from a polynomial <span class="math notranslate nohighlight">\(ax^2+bx+c\)</span> and gives you a list of the roots. Just apply the standard quadratic formula. For now, you can assume that <span class="math notranslate nohighlight">\(b^2-4ac&gt;0\)</span> so you can take the square root, and you can assume <code class="docutils literal notranslate"><span class="pre">a</span></code> is not zero. Have it give the smaller root first (you can use the built in function <code class="docutils literal notranslate"><span class="pre">sorted</span></code> for this).</p></li>
</ol>
<h3 style="background-color:lightblue"> Write Answers for Exercise 4 Part 1 Below </h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lab_5a_checker</span>

<span class="k">def</span> <span class="nf">naive_roots</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="c1"># fill in the formula here</span>
    
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span>

<span class="n">lab_5a_checker</span><span class="o">.</span><span class="n">check_naive_roots</span><span class="p">(</span><span class="n">naive_roots</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Factor the polynomial <span class="math notranslate nohighlight">\(x^2-1,000,000.000,001 x +1\)</span> exactly, on paper (note the decimal place in <code class="docutils literal notranslate"><span class="pre">b</span></code>). What should the roots be?</p></li>
</ol>
<h3 style="background-color:lightblue"> Write Answers for Exercise 4 Part 2 Below </h3><ol class="simple">
<li><p>Apply your simple root-finding function to this polynomial. What are the relative errors in your computed roots, compared to the true values? Explain why one of these has a larger relative error.</p></li>
</ol>
<h3 style="background-color:lightblue"> Write Answers for Exercise 4 Part 3 Below </h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># call your root finding function</span>
</pre></div>
</div>
</div>
</div>
<p>Here is a simple technique we can apply to reduce the error. Let’s assume for now that <code class="docutils literal notranslate"><span class="pre">b</span></code> is a negative number. So, we get cancellation in the numerator when subtracting <span class="math notranslate nohighlight">\(-b\)</span> and <span class="math notranslate nohighlight">\(\sqrt{b^2-4ac}\)</span>. In this case, just multiply by one in a clever way:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{-b-\sqrt{b^2-4ac}}{2a}
&amp;= \frac{-b-\sqrt{b^2-4ac}}{2a} \times \frac{-b+\sqrt{b^2-4ac}}{-b+\sqrt{b^2-4ac}}\\
&amp;= \frac{b^2-(b^2-4ac)}{2a(-b+\sqrt{b^2-4ac})}\\
&amp;= \frac{2c}{-b+\sqrt{b^2-4ac}}
\end{align*}\]</div>
<p>Since <code class="docutils literal notranslate"><span class="pre">b</span></code> is negative and <code class="docutils literal notranslate"><span class="pre">-b</span></code> is positive, there is no cancellation here! We can use this formula to compute the “-” root and the original formula to compute the “+” root.</p>
<ol class="simple">
<li><p>Assuming <code class="docutils literal notranslate"><span class="pre">b</span></code> is always negative, rewrite your function to use this formula for one root and the standard formula for the other root. Compute the relative errors on the example above, using your new formula.</p></li>
</ol>
<h3 style="background-color:lightblue"> Write Answers for Exercise 4 Part 4 Below </h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># rewrite your function</span>
<span class="kn">import</span> <span class="nn">lab_5a_checker</span>

<span class="k">def</span> <span class="nf">naive_roots</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="c1"># fill in the formula here</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span>

<span class="n">lab_5a_checker</span><span class="o">.</span><span class="n">check_naive_roots</span><span class="p">(</span><span class="n">naive_roots</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Figure out a similar formula which works when <code class="docutils literal notranslate"><span class="pre">b</span></code> is always positive. Use both formulas to write a function to compute the roots which is always accurate, and does not suffer from catestrophic cancellation.</p></li>
</ol>
<h3 style="background-color:lightblue"> Write Answers for Exercise 4 Part 5 Below </h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># write a better root finding function</span>
<span class="kn">import</span> <span class="nn">lab_5a_checker</span>

<span class="k">def</span> <span class="nf">naive_roots</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="c1"># fill in the formula here</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span>

<span class="n">lab_5a_checker</span><span class="o">.</span><span class="n">check_naive_roots</span><span class="p">(</span><span class="n">naive_roots</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Finish off your function by adding a special case for if <code class="docutils literal notranslate"><span class="pre">c</span></code> is exactly zero (don’t want to divide by zero, after all!). We have provided a test you can use to check your work.</p></li>
</ol>
<h3 style="background-color:lightblue"> Write Answers for Exercise 4 Part 6 Below </h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># add special cases for a and c</span>
<span class="k">def</span> <span class="nf">roots</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="c1"># fill in the formula here</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">])</span>

<span class="n">lab_5a_checker</span><span class="o">.</span><span class="n">check_roots</span><span class="p">(</span><span class="n">roots</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This example shows how catestrophic cancellation can occur even in friendly, well-known functions. This also shows that we can usually deal with it, by doing some clever algebra. This is such a common issue that there are now tools available to identify and fix catestrophic cancellation. If you are curious, check out <a class="reference external" href="http://herbie.uwplse.org/">Herbie</a>, which a friend of mine helped to create.</p>
</section>
</section>
<section id="span-style-color-orange-4-numerical-differentiation-span">
<h2><span style="color:orange;"> 4. Numerical Differentiation </span><a class="headerlink" href="#span-style-color-orange-4-numerical-differentiation-span" title="Permalink to this headline">#</a></h2>
<p>Now you are prepared to see the major problem we are up against when trying to compute derivatives using floating-point arithmetic. Remember that by definition, the derivative of a function <span class="math notranslate nohighlight">\(f(x)\)</span> is</p>
<div class="math notranslate nohighlight">
\[
f'(x) = \lim_{h\to 0} \frac{f(x+h)-f(x)}{h}
\]</div>
<p>This suggests a simple way to compute a derivative: pick a really small number <span class="math notranslate nohighlight">\(h\)</span>, and compute <span class="math notranslate nohighlight">\(\frac{f(x+h)-f(x)}{h}\)</span>. Since <span class="math notranslate nohighlight">\(h\)</span> is just a small but finite number, this is called the <em>finite difference method</em>.</p>
<section id="span-style-color-red-exercise-5-span">
<h3><span style="color:red;"> Exercise 5 </span><a class="headerlink" href="#span-style-color-red-exercise-5-span" title="Permalink to this headline">#</a></h3>
<p>Let’s see what happens when we apply this procedure blindly. We will apply this formula for <span class="math notranslate nohighlight">\(f(x)=x^2\)</span> at the point <span class="math notranslate nohighlight">\(x=4\)</span>. The correct derivative should be 8. We will compute the relative error in using the finite difference method, for various values of <span class="math notranslate nohighlight">\(h\)</span>. It is easy to get a good spread of values for <span class="math notranslate nohighlight">\(h\)</span>, in a geometric sequence:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="mf">1e-15</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Part 1</strong></p>
<p>Make an array giving approximations to <span class="math notranslate nohighlight">\(f'(4)\)</span> for each value of <code class="docutils literal notranslate"><span class="pre">h</span></code>, using the finite difference method. Then, compute the relative error in this approximation using the relative error formula. Tools to check your work are available. You must use arrays and broadcasting to get full credit here.</p>
<h3 style="background-color:lightblue;"> Write Answers for Exercise 5 Part 1 Below </h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">approximation</span> <span class="o">=</span> 
<span class="n">relative_error</span> <span class="o">=</span> 
<span class="n">lab_5a_checker</span><span class="o">.</span><span class="n">check_finite_difference</span><span class="p">(</span><span class="n">approximation</span><span class="p">,</span> <span class="n">relative_error</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Part 2</strong></p>
<p>Now that we have computed the relative error, let’s inspect it in a plot. We will use a logarithmic scale for the x and y axes, which will help us to compare very different values. Since we are taking a logarithm, we must look at the absolute value of the relative error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="nb">abs</span><span class="p">(</span><span class="n">relative_error</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;step size $h$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;relative error in computing the finite difference&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>In light of what you have learned today about catastrophic cancellation, explain the shape of the curve you get. Explain why it is not a good idea to just make <span class="math notranslate nohighlight">\(h\)</span> as small as possible. What is the smallest relative error we can achieve using this method?</p>
<h3 style="background-color:lightblue;"> Write Answers for Exercise 5 Part 2 Below </h3></section>
</section>
<section id="span-style-color-orange-5-finite-difference-schemes-span">
<h2><span style="color:orange;"> 5. Finite Difference Schemes </span><a class="headerlink" href="#span-style-color-orange-5-finite-difference-schemes-span" title="Permalink to this headline">#</a></h2>
<p>This shows the basic struggle of computing numerical derivatives: the definition of the derivative requires <code class="docutils literal notranslate"><span class="pre">h</span></code> to be infinitely small, but we can’t practically make it that small. This isn’t just because of catastrophic cancellation, by the way – often when working with real data you are limited in how fast you can collect it. Hence, our goal will be to find ways to get more accurate estimates of the derivative without just making the step size <span class="math notranslate nohighlight">\(h\)</span> tiny. We will consider <span class="math notranslate nohighlight">\(h\)</span> to be fixed, and try to get our estimate as good as possible.</p>
<section id="bias-in-the-forward-difference">
<h3>Bias in the forward difference<a class="headerlink" href="#bias-in-the-forward-difference" title="Permalink to this headline">#</a></h3>
<p>Let’s examine the finite difference method, applied to the function <span class="math notranslate nohighlight">\(f(x) = x^3\)</span> at <span class="math notranslate nohighlight">\(x=2\)</span>. For ease of illustration, let’s choose <span class="math notranslate nohighlight">\(h=0.5\)</span>. Our estimate of <span class="math notranslate nohighlight">\(f'(2)\)</span> is</p>
<div class="math notranslate nohighlight">
\[
f'(2)\approx \frac{(2+0.5)^3-2^3}{0.5}.
\]</div>
<p>Is this an over-estimate or an under-estimate? Let’s draw a picture to help us see.</p>
</section>
<section id="span-style-color-red-exercise-6-span">
<h3><span style="color:red;"> Exercise 6 </span><a class="headerlink" href="#span-style-color-red-exercise-6-span" title="Permalink to this headline">#</a></h3>
<p><strong>Part 1</strong></p>
<p>Find an equation for the tangent line to <span class="math notranslate nohighlight">\(y=f(x)\)</span> at <span class="math notranslate nohighlight">\(x=2\)</span>.</p>
<p><strong>Part 2</strong></p>
<p>Find an equation for the secant line intersecting <span class="math notranslate nohighlight">\(y=f(x)\)</span> at <span class="math notranslate nohighlight">\(x=2\)</span> and <span class="math notranslate nohighlight">\(x=2.5\)</span>.</p>
<h3 style="background-color:lightblue;"> Write Answers for Exercise 6 Below </h3><p>Fill in the formulas you found for the secant and tangent lines below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">cube</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span>
<span class="n">tangent</span> <span class="o">=</span> <span class="c1">#fill in here</span>
<span class="n">secant</span> <span class="o">=</span> <span class="c1">#fill in here</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cube</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$x^3$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tangent</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;tangent&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">secant</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;secant&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">27</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>That shows it visually: the slope of the secant line is bigger than the slope of the tangent line. We can see it algebraically too:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{(2+0.5)^3-2^3}{0.5}
&amp;=\frac{12(0.5)+6(0.5)^2+(0.5)^3}{0.5}\\
&amp;=12+6(0.5)+(0.5)^2
\end{align*}\]</div>
<p>The correct derivative is 12, and the other terms (most of all the term <span class="math notranslate nohighlight">\(6(0.5)\)</span>) are making it too big.</p>
<p>When we choose <span class="math notranslate nohighlight">\(h\)</span> to be a positive number, we call that a <em>forward difference</em>. What if we try making <span class="math notranslate nohighlight">\(h\)</span> negative, doing a so-called <em>backward difference</em>? Try that now.</p>
</section>
<section id="span-style-color-red-exercise-7-span">
<h3><span style="color:red;"> Exercise 7 </span><a class="headerlink" href="#span-style-color-red-exercise-7-span" title="Permalink to this headline">#</a></h3>
<p><strong>Part 1</strong></p>
<p>Create a similar plot to show what happens if <span class="math notranslate nohighlight">\(h=-0.5\)</span>.</p>
<p><strong>Part 2</strong></p>
<p>Is the slope of the secant line too big, or too small, in this case? Support your claim using your figure. How is this related to the curvature of the function <span class="math notranslate nohighlight">\(f(x)=x^3\)</span>?</p>
<h3 style="background-color:lightblue;"> Write Answers for Exercise 7 Part 1 Below </h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">cube</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span>
<span class="n">tangent</span> <span class="o">=</span> <span class="c1">#fill in here</span>
<span class="n">secant</span> <span class="o">=</span> <span class="c1">#fill in here</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cube</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$x^3$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tangent</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;tangent&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">secant</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;secant&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">27</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<h3 style="background-color:lightblue;"> Write Answers for Exercise 7 Part 2 Below </h3></section>
<section id="correcting-the-bias">
<h3>Correcting the bias<a class="headerlink" href="#correcting-the-bias" title="Permalink to this headline">#</a></h3>
<p>As you have noticed, the forward difference gave us an over-estimate while the backward difference gave an under-estimate. This gives us a clear way to do better: we could average these answers out, which would give us a (hopefully) unbiased answer. Algebraically, this would look something like this:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{1}{2}\left[ \frac{f(x+h) - f(x)}{h} + \frac{f(x-h)-f(x)}{-h} \right]
&amp;= \frac{f(x+h)-f(x)-f(x-h) + f(x)}{2h}\\
&amp;= \frac{f(x+h)-f(x-h)}{2h}
\end{align*}\]</div>
<p>This is the <em>symmetric difference</em> scheme. You can think of it as a secant line which doesn’t go through a given point, but rather goes through its neighbors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">cube</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span>
<span class="n">tangent</span> <span class="o">=</span> <span class="mi">12</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">8</span>
<span class="n">secant</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.5</span><span class="o">**</span><span class="mi">3</span><span class="o">-</span><span class="mf">1.5</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">1.5</span><span class="p">)</span><span class="o">+</span><span class="mf">1.5</span><span class="o">**</span><span class="mi">3</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">cube</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;$x^3$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tangent</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;tangent&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">secant</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;secant&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">27</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>No obvious bias! We can still work out algebraically that it’s not exact:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{(2+0.5)^3 - (2-0.5)^3}{2*(0.5)} = 12.25
\end{align*}\]</div>
<p>This is still a slight overestimate. However, it’s clearly way better for any given step size <span class="math notranslate nohighlight">\(h\)</span>. The error gets small really fast, too: if we instead had <span class="math notranslate nohighlight">\(h=10^{-9}\)</span>, the error would be just <span class="math notranslate nohighlight">\((10^{-9})^2 = 10^{-18}\)</span>, which is below the floating-point error. Symmetric difference is better than forward difference!</p>
</section>
<section id="span-style-color-red-exercise-8-span">
<h3><span style="color:red;"> Exercise 8 </span><a class="headerlink" href="#span-style-color-red-exercise-8-span" title="Permalink to this headline">#</a></h3>
<p>Work out the symmetric difference exactly on paper for the function <span class="math notranslate nohighlight">\(f(x)=5x^2+3x-7\)</span>, for a variable step size <span class="math notranslate nohighlight">\(h\)</span>, at the point <span class="math notranslate nohighlight">\(x=2\)</span>. Find the relative error algebraically, and comment on it.</p>
<h3 style="background-color:lightblue;"> Write Answers for Exercise 8 Below </h3></section>
</section>
<section id="span-style-color-orange-6-unequal-step-sizes-span">
<h2><span style="color:orange;"> 6. Unequal Step Sizes </span><a class="headerlink" href="#span-style-color-orange-6-unequal-step-sizes-span" title="Permalink to this headline">#</a></h2>
<p>In Exercise 8 you should have found that the symmetric difference scheme gave exactly the right answer. This is not just a coincidence. Whenever your function is a quadratic polynomial, the symmetric finite difference scheme gives exactly the correct answer. A scheme with this property is called <strong>second-order accurate</strong>.</p>
<p>The symmetric finite difference scheme is a very powerful way to estimate derivatives. It’s a second-order accurate scheme, and it only uses two points to estimate the derivative. Unfortunately, it only works when the step sizes are equal, that is, when the samples are evenly spaced. Frequently we are not so lucky as to have evenly spaced samples. Data often arrive whenever they are available, and we have to deal with that. Fortunately, we can still get a second-order accurate scheme, even if the step sizes are unequal. In this section, we will develop a second-order accurate scheme to estimate the derivative of a function at a point <span class="math notranslate nohighlight">\(x=b\)</span> using nearby points <span class="math notranslate nohighlight">\(x=a\)</span> to the left and <span class="math notranslate nohighlight">\(x=c\)</span> to the right, so <span class="math notranslate nohighlight">\(a&lt;b&lt;c\)</span>. That is, we will find numbers <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span>, and <span class="math notranslate nohighlight">\(\gamma\)</span> such that</p>
<div class="math notranslate nohighlight">
\[
f'(b) = \alpha f(a) + \beta f(b) + \gamma f(c) \tag{$*$}
\]</div>
<p>whenever <span class="math notranslate nohighlight">\(f(x)\)</span> is a quadratic polynomial. These numbers should depend on <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, and <span class="math notranslate nohighlight">\(c\)</span>, but they shouldn’t depend on <span class="math notranslate nohighlight">\(f\)</span>. There are many ways we could figure out the formulas for <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span>, and <span class="math notranslate nohighlight">\(\gamma\)</span>. Next we will walk you through one of the simplest ways.</p>
<section id="a-quick-way-to-figure-out-alpha-beta-and-gamma">
<h3>A quick way to figure out <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span>, and <span class="math notranslate nohighlight">\(\gamma\)</span>.<a class="headerlink" href="#a-quick-way-to-figure-out-alpha-beta-and-gamma" title="Permalink to this headline">#</a></h3>
<p>We know that <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span>, and <span class="math notranslate nohighlight">\(\gamma\)</span> will not depend on <span class="math notranslate nohighlight">\(f\)</span>. For some values of <span class="math notranslate nohighlight">\(f\)</span>, the values of <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span>, and <span class="math notranslate nohighlight">\(\gamma\)</span> will be obvious. For example, let’s say we choose <span class="math notranslate nohighlight">\(f(x)=(x-b)(x-c)\)</span>. We can just evaluate each term in (<span class="math notranslate nohighlight">\(*\)</span>) directly.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
f'(x) &amp;= 2x-b-c\\
f'(b) &amp;= b-c\\
f(a) &amp;= (a-b)(a-c)\\
f(b) &amp;= (b-b)(b-c)=0\\
f(c) &amp;= (c-b)(c-c)=0
\end{align*}\]</div>
<p>By substituting these values, equation (<span class="math notranslate nohighlight">\(*\)</span>) becomes</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
b-c &amp;= \alpha (a-b)(a-c)\\
\alpha &amp;= \frac{b-c}{(a-b)(a-c)}\\
&amp;= \frac{1}{c-a}-\frac{1}{b-a}
\end{align*}\]</div>
<p>By choosing <span class="math notranslate nohighlight">\(f\)</span> carefully, we were able to get the value of <span class="math notranslate nohighlight">\(\alpha\)</span> directly. The trick was to choose <span class="math notranslate nohighlight">\(f\)</span> so that the terms <span class="math notranslate nohighlight">\(f(a)\)</span> and <span class="math notranslate nohighlight">\(f(c)\)</span> worked out to be zero.</p>
<p>We will work out how to find <span class="math notranslate nohighlight">\(\alpha\)</span> together as another example. Then, you will be asked to choose <span class="math notranslate nohighlight">\(f\)</span> to give you <span class="math notranslate nohighlight">\(\gamma\)</span>. Since I want <span class="math notranslate nohighlight">\(f(a)=0\)</span> and <span class="math notranslate nohighlight">\(f(c)=0\)</span>, I will choose <span class="math notranslate nohighlight">\(f(x)=(x-a)(x-c)\)</span>. This quadratic has zeros at <span class="math notranslate nohighlight">\(x=a\)</span> and <span class="math notranslate nohighlight">\(x=c\)</span>, which is just what I want. Then I can fill out the values as before.</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
f'(x) &amp;= 2x-a-c\\
f'(b) &amp;= 2b-a-c\\
f(a) &amp;= (a-a)(a-c)=0\\
f(b) &amp;= (b-a)(b-c)\\
f(c) &amp;= (c-a)(c-c)=0
\end{align*}\]</div>
<p>By substituting these values, equation (<span class="math notranslate nohighlight">\(*\)</span>) becomes</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
2b-a-c &amp;= \beta(b-a)(b-c)\\
\beta &amp;= \frac{2b-a-c}{(b-a)(b-c)}\\
&amp;= \frac{1}{b-a}-\frac{1}{c-b}
\end{align*}\]</div>
</section>
<section id="span-style-color-red-exercise-9-h3">
<h3><span style="color:red;"> Exercise 9 </h3><a class="headerlink" href="#span-style-color-red-exercise-9-h3" title="Permalink to this headline">#</a></h3>
<p>Choose a quadratic polynomial <span class="math notranslate nohighlight">\(f(x)\)</span> so that when you substitute <span class="math notranslate nohighlight">\(f(x)\)</span> into (<span class="math notranslate nohighlight">\(*\)</span>), you find the value of <span class="math notranslate nohighlight">\(\gamma\)</span> using the method demonstrated above. For your choice of <span class="math notranslate nohighlight">\(f(x)\)</span>, copy the following table into your answer and fill it out.</p>
<div class="highlight-latex notranslate"><div class="highlight"><pre><span></span><span class="k">\begin</span><span class="nb">{</span>align*<span class="nb">}</span>
f&#39;(x) <span class="nb">&amp;</span>=     <span class="k">\\</span>
f&#39;(b) <span class="nb">&amp;</span>=     <span class="k">\\</span>
f(a)  <span class="nb">&amp;</span>=     <span class="k">\\</span>
f(b)  <span class="nb">&amp;</span>=     <span class="k">\\</span>
f(c)  <span class="nb">&amp;</span>= 
<span class="k">\end</span><span class="nb">{</span>align*<span class="nb">}</span>
</pre></div>
</div>
<p>Then, substitute the values into (<span class="math notranslate nohighlight">\(*\)</span>) and write that equation in your answer as well. Solve the equation for <span class="math notranslate nohighlight">\(\gamma\)</span> in terms of <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, and <span class="math notranslate nohighlight">\(c\)</span>. You should find that</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\gamma = \frac{1}{c-b}-\frac{1}{c-a}.
\end{align*}\]</div>
<h3 style="background-color:lightblue;"> Write Answers for Exercise 9 Below </h3></section>
<section id="span-style-color-red-exercise-10-span">
<h3><span style="color:red;"> Exercise 10 </span><a class="headerlink" href="#span-style-color-red-exercise-10-span" title="Permalink to this headline">#</a></h3>
<p>Substitute <span class="math notranslate nohighlight">\(f(x)=1\)</span> in (<span class="math notranslate nohighlight">\(*\)</span>). What relationship do you find between <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span>, and <span class="math notranslate nohighlight">\(\gamma\)</span>? Substitute the formulas we found for <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span>, and <span class="math notranslate nohighlight">\(\gamma\)</span> into that expression to verify that our answers are correct.</p>
<h3 style="background-color:lightblue;"> Write Answers for Exercise 10 Below </h3></section>
</section>
<section id="the-symmetric-finite-difference-method-with-unequal-step-sizes">
<h2>The symmetric finite difference method with unequal step sizes<a class="headerlink" href="#the-symmetric-finite-difference-method-with-unequal-step-sizes" title="Permalink to this headline">#</a></h2>
<p>Suppose we have three x-values <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, and <span class="math notranslate nohighlight">\(c\)</span> with <span class="math notranslate nohighlight">\(a&lt;b&lt;c\)</span>. Suppose further that we have measured <span class="math notranslate nohighlight">\(f(a)\)</span>, <span class="math notranslate nohighlight">\(f(b)\)</span>, and <span class="math notranslate nohighlight">\(f(c)\)</span>. We now have a good way to approximate the derivative of <span class="math notranslate nohighlight">\(f\)</span> at <span class="math notranslate nohighlight">\(b\)</span>. We compute</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\alpha &amp;=\frac{1}{c-a}-\frac{1}{b-a}\\
\beta  &amp;=\frac{1}{b-a}-\frac{1}{c-b}\\
\gamma &amp;=\frac{1}{c-b}-\frac{1}{c-a}\\
f'(b) &amp;\approx \alpha f(a) +\beta f(b) + \gamma f(c)
\end{align*}\]</div>
<p>The final exercise for today walks you through the process of creating a vectorized version of this formula, which computes the symmetric difference scheme for unequal step sizes in a way that is</p>
<ol class="simple">
<li><p>Efficient (very fast to perform)</p></li>
<li><p>Easy to read (easy to see that it does what it should).</p></li>
</ol>
<section id="span-style-color-red-exercise-11-h3">
<h3><span style="color:red;"> Exercise 11 </h3><a class="headerlink" href="#span-style-color-red-exercise-11-h3" title="Permalink to this headline">#</a></h3>
<p>Our function will take two arguments, <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>, each of which is an array. The idea is that <span class="math notranslate nohighlight">\(y\)</span> will have the <span class="math notranslate nohighlight">\(f(x)\)</span> values corresponding to each <span class="math notranslate nohighlight">\(x\)</span> value. It will produce an array of the same shape which has the symmetric finite difference scheme applied to find the first derivative.</p>
<p>When working out a procedure, it is a good idea to have an example at hand so you can follow through the steps. Let’s pick some examples for <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">50.0</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">34</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We can see that the derivative is steeply negative, leveling at the end. That gives us an idea of what we are looking for: our answer will be an array of negative numbers.</p>
<p>In order to make the function we are writing more legible, we will use the same symbols that are in the derivation we did above. Since we want <span class="math notranslate nohighlight">\(f'(x)\)</span> and our approximation gives us <span class="math notranslate nohighlight">\(f'(b)\)</span>, we can just choose <span class="math notranslate nohighlight">\(b=x\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">x</span>
</pre></div>
</div>
</div>
</div>
<p>We want <span class="math notranslate nohighlight">\(a\)</span> to be the number to the left of <span class="math notranslate nohighlight">\(b\)</span>. So, let’s build an array which has all the same numbers as <span class="math notranslate nohighlight">\(x\)</span> but shifted one to the right. Since the leftmost <span class="math notranslate nohighlight">\(x\)</span> has no neighbor to the left, we should instead say that value is missing using the special value <code class="docutils literal notranslate"><span class="pre">nan</span></code>. Here is a quick way to do that:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can see that where <code class="docutils literal notranslate"><span class="pre">b</span></code> has the value <code class="docutils literal notranslate"><span class="pre">7</span></code>, for example, <code class="docutils literal notranslate"><span class="pre">a</span></code> has the value <code class="docutils literal notranslate"><span class="pre">5</span></code> and <code class="docutils literal notranslate"><span class="pre">5</span></code> is the number to the left of <code class="docutils literal notranslate"><span class="pre">7</span></code>. Each column corresponds to the values of <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> at one place in our answer.</p>
<p>Step by step, what we did here was to make an array the same shape as <code class="docutils literal notranslate"><span class="pre">x</span></code> but full of the special value <code class="docutils literal notranslate"><span class="pre">nan</span></code>. Then, we took the spots of <code class="docutils literal notranslate"><span class="pre">a</span></code> starting after the first one, and filled them with values from <code class="docutils literal notranslate"><span class="pre">x</span></code> stopping before the last value of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>We will do the same thing to write <code class="docutils literal notranslate"><span class="pre">c</span></code>, but shifting the values in the other direction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">c</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we have those variables set up, we can compute <code class="docutils literal notranslate"><span class="pre">alpha</span></code>, <code class="docutils literal notranslate"><span class="pre">beta</span></code>, and <code class="docutils literal notranslate"><span class="pre">gamma</span></code> without needing any loops. Numpy will automatically compute each column for us using broadcasting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span>
<span class="n">beta</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Numpy even automatically filled in the values at the ends with <code class="docutils literal notranslate"><span class="pre">nan</span></code>, because we don’t have neighbors there to compute the symmetric difference.</p>
<p><strong>Part 1</strong></p>
<p>Compute <code class="docutils literal notranslate"><span class="pre">gamma</span></code> as well, using broadcasting.</p>
<h3 style="background-color:lightblue;"> Write Answers for Exercise 11 Part 1 Below </h3><p>We also need the values of <span class="math notranslate nohighlight">\(f(a)\)</span>, <span class="math notranslate nohighlight">\(f(b)\)</span>, and <span class="math notranslate nohighlight">\(f(c)\)</span>. We will build those just like we built <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, and <code class="docutils literal notranslate"><span class="pre">c</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
<span class="n">fa</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">fb</span> <span class="o">=</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Part 2</strong></p>
<p>Build an array <code class="docutils literal notranslate"><span class="pre">fc</span></code> which holds the values of <span class="math notranslate nohighlight">\(f(c)\)</span>.</p>
<h3 style="background-color:lightblue;"> Write Answers for Exercise 11 Part 2 Below </h3><p>Now that we have all of our variables set up, computing the derivative is as simple as applying the formula (<span class="math notranslate nohighlight">\(*\)</span>) from above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">derivative</span> <span class="o">=</span> <span class="n">alpha</span><span class="o">*</span><span class="n">fa</span><span class="o">+</span><span class="n">beta</span><span class="o">*</span><span class="n">fb</span><span class="o">+</span><span class="n">gamma</span><span class="o">*</span><span class="n">fc</span>
<span class="nb">print</span><span class="p">(</span><span class="n">derivative</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>What should we do about the missing values? Since we can’t do a symmetric difference, the next best thing is a one-sided difference. Since there are just two of these, we can fill them out manually.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">derivative</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">derivative</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Part 3</strong></p>
<p>Set the last entry of <code class="docutils literal notranslate"><span class="pre">derivative</span></code> similarly. Use negative indices, so that you don’t need to know how many elements are in the array.</p>
<h3 style="background-color:lightblue;"> Write Answers for Exercise 11 Part 3 Below </h3><p><strong>Part 4</strong></p>
<p>Write a function called <code class="docutils literal notranslate"><span class="pre">symmetric_difference</span></code> which computes the symmetric difference for unequal step sizes. You can do this by copying code line-by-line from above – all the code we wrote should work just fine using an arbitrary <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>.</p>
<h3 style="background-color:lightblue;"> Write Answers for Exercise 11 Part 4 Below </h3><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">symmetric_difference</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1">#write a function here!</span>
    
    <span class="k">return</span> <span class="n">derivative</span>

<span class="n">lab_5a_checker</span><span class="o">.</span><span class="n">check_symmetric_difference</span><span class="p">(</span><span class="n">symmetric_difference</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Part 5</strong></p>
<p>In a language like Python (or Julia, or Matlab, for that matter) a so-called “vectorized” procedure goes way faster than looping through the variables, because you can pass all the difficult computation to highly-optimized code (in our case, the code which comes in the package <code class="docutils literal notranslate"><span class="pre">numpy</span></code>). The difference in speed is very small for arrays without very many entries, but when we start to have hundreds or thousands of entries in our arrays it makes a huge difference. That is one reason why people often prefer to write functions which treat the data as arrays, rather than looping through lists like you would do in other languages like C, Java, or Javascript.</p>
<p>Another reason is that many people find the code easier to read, and easier to understand, if it is written in a vectorized way.</p>
<p>Write a few sentences of your thoughts on the matter. Do you find the function <code class="docutils literal notranslate"><span class="pre">symmetric_difference</span></code> you wrote to be easier to read than if it were done with a loop? Which parts are harder to read, which parts easier? Give your honest opinion.</p>
<h3 style="background-color:lightblue;"> Write Answers for Exercise 11 Part 4 Below </h3></section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./labs/5_measure_speeds/a_derivatives"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../../4_measure_tall_things/e_symbolic_error/lab4e.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Week 11: Laboratory 4e</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../b_build_a_tool/lab5b.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Week 13: Laboratory 5b</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Mireille Boutin, Alden Bradford<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>